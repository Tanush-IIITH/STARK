# Shift-Or/Bitap Algorithm for DNA Pattern Matching

A comprehensive from-scratch implementation of the Shift-Or (Bitap) string matching algorithm optimized for DNA sequence analysis, including exact matching, approximate matching, and extended multi-word support.

## Overview

The **Shift-Or algorithm** (also known as Bitap or Baeza-Yates-Gonnet algorithm) is a bit-parallel pattern matching technique that achieves exceptionally fast search times through bitwise operations. This implementation provides three variants:

1. **Exact Matching** (≤64 bp): Single-word bit-parallel for patterns up to 64 base pairs
2. **Approximate Matching** (≤64 bp, k=1,2,3): Allows up to k errors (substitutions, insertions, deletions)
3. **Extended Matching** (>64 bp): Multi-word implementation for patterns up to 800 base pairs

## Features

- ✅ Pure Python implementation with no external dependencies (except matplotlib for visualization)
- ✅ Optimized for DNA sequences (A, C, G, T, N)
- ✅ Bit-parallel operations for maximum efficiency
- ✅ Comprehensive benchmarking suite
- ✅ Memory and performance metrics tracking
- ✅ Jupyter notebooks for large-scale dataset analysis
- ✅ FASTA file utilities included

## Installation

```bash
# Clone or download this repository
cd Shift-Or-Bitap

# Install dependencies
pip install -r requirements.txt
```

## Quick Start

### Exact Matching
```python
from shift_or_exact import ShiftOrExact

text = "ACGTACGTACGT"
pattern = "ACGT"

matcher = ShiftOrExact(pattern)
matches = matcher.search(text)
print(matches)  # [0, 4, 8]
```

### Approximate Matching
```python
from shift_or_approximate import ShiftOrApproximate

text = "ACGTACTTACGT"
pattern = "ACGT"

# Allow up to 1 error
matcher = ShiftOrApproximate(pattern, k=1)
matches = matcher.search(text)  # Returns [(position, error_level), ...]
```

### Extended Matching (>64 bp)
```python
from shift_or_extended import ShiftOrExtended

pattern = "ACGT" * 25  # 100 bp pattern
text = "..." # Your long sequence

matcher = ShiftOrExtended(pattern)
matches = matcher.search(text)
```

## Project Structure

```
Shift-Or-Bitap/
├── Core Algorithm Files
│   ├── shift_or_exact.py           # Exact matching (≤64 bp)
│   ├── shift_or_approximate.py     # Approximate matching (≤64 bp)
│   ├── shift_or_extended.py        # Extended for >64 bp
│   └── shift_or_utils.py           # DNA utilities
│
├── Benchmarking
│   ├── benchmark_exact.py          # Exact matching benchmarks
│   ├── benchmark_approximate.py    # Approximate matching benchmarks
│   ├── benchmark_extended.py       # Extended benchmarks
│   └── test_quick.py              # Quick validation tests
│
├── Examples and Documentation
│   ├── example_usage.py            # Usage examples
│   ├── README.md                   # This file
│   ├── ALGORITHM_EXPLANATION.md    # Technical details
│   └── requirements.txt            # Dependencies
│
├── Jupyter Notebooks (create these)
│   ├── shift_or_exact_nb.ipynb
│   ├── shift_or_approximate_nb.ipynb
│   └── shift_or_extended_nb.ipynb
│
└── Results (generated by benchmarks)
    ├── results_exact/              # Exact matching results
    ├── results_approximate/        # Approximate matching results
    └── results_extended/           # Extended matching results
```

## Usage Examples

See `example_usage.py` for comprehensive examples including:
- Basic exact and approximate matching
- Extended pattern matching
- Multiple pattern search
- FASTA file processing
- Performance comparisons

## Running Tests

```bash
# Quick validation tests
python test_quick.py

# Run example demonstrations
python example_usage.py
```

## Running Benchmarks

### Single Dataset
```bash
# Exact matching
python benchmark_exact.py path/to/genome.fna results_exact/dataset_name

# Approximate matching
python benchmark_approximate.py path/to/genome.fna results_approximate/dataset_name

# Extended matching
python benchmark_extended.py path/to/genome.fna results_extended/dataset_name
```

### Multiple Datasets
Use the provided Jupyter notebooks to process all datasets:
- `shift_or_exact_nb.ipynb` - Process all datasets with exact matching
- `shift_or_approximate_nb.ipynb` - Process with k=1,2,3 approximate matching
- `shift_or_extended_nb.ipynb` - Process with extended patterns

## Algorithm Complexity

### Exact Matching
- **Preprocessing**: O(m × |Σ|) where m = pattern length, |Σ| = alphabet size (4 for DNA)
- **Search**: O(n) where n = text length
- **Space**: O(|Σ|)

### Approximate Matching
- **Preprocessing**: O(m × |Σ|)
- **Search**: O(k × n) where k = number of errors allowed
- **Space**: O(k × |Σ|)

### Extended Matching
- **Preprocessing**: O(m × |Σ| × ⌈m/64⌉)
- **Search**: O(n × ⌈m/64⌉)
- **Space**: O(|Σ| × ⌈m/64⌉)

## Pattern Length Limitations

- **Standard (≤64 bp)**: Single machine word, optimal performance
- **Extended (>64 bp)**: Multi-word implementation, slight performance overhead
- **Maximum**: 800 bp for extended version

## Output Files

Each dataset generates:

### Exact & Extended Matching (5 files)
1. `scaling_results.csv` - Performance vs text size
2. `scaling_time_memory.jpg` - Time/memory plots
3. `pattern_length_results.csv` - Performance vs pattern length
4. `pattern_length_time_memory.jpg` - Pattern length plots
5. `multiple_patterns_summary.json` - Multiple pattern results

### Approximate Matching (15 files = 5 per k value)
- Same as above, but separate files for k=1, k=2, k=3
- Example: `scaling_results_k1.csv`, `scaling_results_k2.csv`, etc.

## Metrics Tracked

Standard metrics:
- Preprocessing time
- Search time
- Peak memory usage
- Number of matches found

Shift-Or specific metrics:
- Bitmask construction time
- Total bit operations
- Number of state vectors
- Implementation type (single-word/multi-word)

## References

- Baeza-Yates, R., & Gonnet, G. H. (1992). "A new approach to text searching". CACM.
- Wu, S., & Manber, U. (1992). "Fast text searching allowing errors". CACM.
- Original algorithm by Dömölki, B. (1964)

## Author

DNA Pattern Matching Project  
November 2025

## License

This implementation is for academic and research purposes.
